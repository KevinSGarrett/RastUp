---
id: TD-596.2
title: "**1.5.B Architecture (AWS Amplify Gen‑2 / AppSync / Stripe‑first)**"
source_doc: "TechDevBlueprint.docx"
source_path: "docs\blueprints\tech\TD-596-15-trust-safety-verification-technical-development-plan\TD-596.2-15b-architecture-aws-amplify-gen2-appsync-stripefirst.md"
parent_id: TD-596
anchor: "TD-596.2"
checksum: "sha256:da6a80c9b472cb226948f599e242fda32014274f53c6c4f80f46691ac16d6906"
last_modified: "2025-11-06T20:40:46Z"
doc_kind: "TD"
h_level: 3
---
<a id="TD-596.2"></a>
### **1.5.B Architecture (AWS Amplify Gen‑2 / AppSync / Stripe‑first)**

**Core services**

- **Auth & RBAC:** Cognito (18+ attestation at signup; IDV status flags via custom attributes).

- **GraphQL API:** AppSync (owner‑authorized mutations; admin backdoor via IAM).

- **Data:** DynamoDB (PII & case records), S3 (evidence, redacted exports), EventBridge (safety events), Step Functions (IDV & background‑check orchestration), CloudWatch (alarms & dashboards).

- **Payments & Payouts:** Stripe Connect (Express) with **Stripe Identity** for IDV to tightly couple KYC ➜ payouts; **ACH via Link** (Plaid optional fallback for non‑Link banks).

- **Background checks (Trusted Pro):** Checkr (default) with webhooks to Step Functions.

- **Content moderation:** Hybrid pipeline:

  - **Tier‑0** (cheap/fast): keyword filters + on‑upload thumbnail NSFW classifier (open‑source) to set *content.sensitivity*.
  - **Tier‑1** (vendor): image/video moderation via AWS Rekognition (labels: Explicit Nudity, Suggestive, Violence, etc.).
  - **Tier‑2** (human): Trust queue in Admin with side‑by‑side evidence & policy rubric.

**Cost rule:** Tier‑0 runs for every upload; Tier‑1 runs on (a) high‑reach surfaces, (b) uncertain Tier‑0 results, (c) reports/appeals. Human review only on escalations. This keeps moderation spend elastic while meeting your **SFW‑only public** commitment.

NonTechBlueprint_Part3

**Safe‑Mode data flow**

- Upload ➜ moderation pipeline sets *media.safeModeRequired=true\|false* + *sensitivity=none\|lingerie\|mature*.
- **Default Safe‑Mode ON** for unauth’d & first‑visit sessions; signed‑in adults can toggle. Frontend & Search respect these flags; **FanSub** tabs render only if Safe‑Mode is OFF.

NonTechBlueprint
