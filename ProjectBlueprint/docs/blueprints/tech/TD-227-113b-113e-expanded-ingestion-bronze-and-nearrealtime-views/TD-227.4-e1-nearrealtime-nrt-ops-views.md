---
id: TD-227.4
title: "**E.1 Near‑Real‑Time (NRT) Ops Views**"
source_doc: "TechDevBlueprint.docx"
source_path: "docs\blueprints\tech\TD-227-113b-113e-expanded-ingestion-bronze-and-nearrealtime-views\TD-227.4-e1-nearrealtime-nrt-ops-views.md"
parent_id: TD-227
anchor: "TD-227.4"
checksum: "sha256:e63bc9ecee1806f28794d5eb4b94fb719fe9af1de785af74275d59f2d46a96de"
last_modified: "2025-11-06T20:40:46Z"
doc_kind: "TD"
h_level: 3
---
<a id="TD-227.4"></a>
### **E.1 Near‑Real‑Time (NRT) Ops Views**

- Use **Athena CTAS** every 5–10 min to create small **Parquet** materializations for Admin dashboards.

**Example: payout backlog by city (last 24h)**

*CREATE TABLE IF NOT EXISTS ops_payout_backlog*  
*WITH (*  
*format='PARQUET',*  
*parquet_compression='SNAPPY',*  
*partitioned_by=array\['dt'\]*  
*) AS*  
*SELECT*  
*date_format(received_at, '%Y-%m-%d') AS dt,*  
*coalesce(b.payload_json.city, 'unknown') AS city,*  
*count_if(b.event='payout.queued') AS queued,*  
*count_if(b.event='payout.paid') AS paid,*  
*count_if(b.event='payout.failed') AS failed,*  
*(count_if(b.event='payout.queued') - count_if(b.event='payout.paid')) AS backlog*  
*FROM (*  
*SELECT*  
*event,*  
*received_at,*  
*json_parse(payload) AS payload_json*  
*FROM bronze_events*  
*WHERE dt \>= date_format(date_add('day', -1, current_date), '%Y-%m-%d')*  
*AND env='prod'*  
*) b*  
*GROUP BY 1,2;*  

Schedule via **Athena Scheduler** or a small **Step Functions** state machine.
