---
id: TD-291.1
title: "**B.1 Aurora (source of truth)**"
source_doc: "TechDevBlueprint.docx"
source_path: "docs\blueprints\tech\TD-291-116b-data-model-aurora-dynamo-typesense\TD-291.1-b1-aurora-source-of-truth.md"
parent_id: TD-291
anchor: "TD-291.1"
checksum: "sha256:f51b15687428dc77bed2ed871661124c79c3c1aac505a9e8f9440b80d4c978e8"
last_modified: "2025-11-06T20:40:46Z"
doc_kind: "TD"
h_level: 3
---
<a id="TD-291.1"></a>
### **B.1 Aurora (source of truth)**

*-- Saved searches (people & studios)*  
*create table saved_search (*  
*search_id text primary key, -- ssv\_...*  
*user_id text not null, -- usr\_...*  
*scope text not null check (scope in ('people','studios')),*  
*query_json jsonb not null, -- normalized filters (ANY/ALL groups)*  
*city text not null,*  
*paused_until date, -- 30-day pause*  
*last_alert_dt date, -- last day an alert was sent*  
*created_at timestamptz not null default now(),*  
*updated_at timestamptz not null default now()*  
*);*  
  
*-- Alert sends (daily dedupe)*  
*create table saved_search_alert (*  
*alert_id text primary key, -- ssa\_...*  
*search_id text not null references saved_search(search_id) on delete cascade,*  
*alert_dt date not null,*  
*match_count int not null,*  
*email_sent boolean not null default false,*  
*inapp_created boolean not null default false,*  
*created_at timestamptz not null default now(),*  
*unique (search_id, alert_dt)*  
*);*  
  
*-- Follow graph (for Feed)*  
*create table follow (*  
*follower_user_id text not null,*  
*target_id text not null, -- usr\_... (people) or fsc\_... (Fan-Sub creator)*  
*target_kind text not null check (target_kind in ('service_profile','fansub_creator')),*  
*created_at timestamptz not null default now(),*  
*primary key (follower_user_id, target_id, target_kind)*  
*);*  
  
*-- Feed posts metadata (case studies, availability cards, touring chips, verified studio slots)*  
*create table feed_post (*  
*feed_id text primary key, -- fdp\_...*  
*author_id text not null, -- usr\_... or fsc\_...*  
*role_tags text\[\] not null, -- \['Model','Photog',...\]*  
*kind text not null check (kind in ('case_study','availability','touring','studio_slot','influence')),*  
*title text not null,*  
*body_md text,*  
*media_preview jsonb not null default '\[\]'::jsonb, -- SFW previews*  
*nsfw_band int not null default 0, -- 0 allow,1 blur,2 block*  
*city text, -- for touring/availability*  
*verified_chip boolean not null default false,*  
*is_published boolean not null default false,*  
*created_at timestamptz not null default now(),*  
*updated_at timestamptz not null default now()*  
*);*  
  
*-- Referrals & credits (ledger-based)*  
*create table referral_program (*  
*program_id text primary key, -- rpr\_...*  
*kind text not null check (kind in ('provider_invites_provider','buyer_invites_buyer','cross_side')),*  
*reward_bips int not null default 0, -- optional future %*  
*reward_fixed_cents int not null default 0, -- e.g., \$1500 = \$15.00*  
*credit_scope text not null, -- 'buyer_fee_only' etc.*  
*monthly_cap int not null default 5, -- per-user awards cap*  
*active boolean not null default true,*  
*created_at timestamptz not null default now()*  
*);*  
  
*create table referral_invite (*  
*invite_id text primary key, -- rfi\_...*  
*program_id text not null references referral_program(program_id),*  
*inviter_user_id text not null,*  
*invitee_user_id text, -- populated after signup*  
*invitee_email_sha text not null, -- hashed*  
*source text, -- sharecard/linkinbio/â€¦*  
*device_fp text, -- device fingerprint*  
*ip_addr_sha text,*  
*created_at timestamptz not null default now(),*  
*accepted_at timestamptz*  
*);*  
  
*-- Credit ledger entries (immutable)*  
*create table credit_ledger (*  
*entry_id text primary key, -- crl\_...*  
*user_id text not null,*  
*kind text not null check (kind in ('award','clawback','redeem')),*  
*program_id text,*  
*amount_cents int not null,*  
*currency text not null default 'USD',*  
*reason text not null,*  
*related_id text, -- booking_id, invite_id*  
*created_at timestamptz not null default now()*  
*);*
