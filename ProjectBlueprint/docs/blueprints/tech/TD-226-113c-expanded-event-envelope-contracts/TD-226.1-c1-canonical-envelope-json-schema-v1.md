---
id: TD-226.1
title: "**C.1 Canonical envelope (JSON Schema v1)**"
source_doc: "TechDevBlueprint.docx"
source_path: "docs\blueprints\tech\TD-226-113c-expanded-event-envelope-contracts\TD-226.1-c1-canonical-envelope-json-schema-v1.md"
parent_id: TD-226
anchor: "TD-226.1"
checksum: "sha256:42e4d2e5634e74468ec44d2d4c0f4c771eb5d846a2935fe847ce2b716b190135"
last_modified: "2025-11-06T20:40:46Z"
doc_kind: "TD"
h_level: 3
---
<a id="TD-226.1"></a>
### **C.1 Canonical envelope (JSON Schema v1)**

*{*  
*"\$id": "*[*https://rastup.com/schemas/event-envelope.v1.json*](https://rastup.com/schemas/event-envelope.v1.json)*",*  
*"\$schema": "*[*https://json-schema.org/draft/2020-12/schema*](https://json-schema.org/draft/2020-12/schema)*",*  
*"type": "object",*  
*"required": \["event", "v", "occurred_at", "received_at", "context", "ids", "payload"\],*  
*"properties": {*  
*"event": { "type": "string", "pattern": "^\[a-z0-9\_.\]+\$" },*  
*"v": { "type": "integer", "enum": \[1\] },*  
*"occurred_at": { "type": "string", "format": "date-time" },*  
*"received_at": { "type": "string", "format": "date-time" },*  
*"user_id": { "type": "string", "pattern": "^usr\_\[A-Za-z0-9\]+\$" },*  
*"anon_id": { "type": "string", "pattern": "^an\_\[A-Za-z0-9\]+\$" },*  
*"session_id": { "type": "string", "pattern": "^ses\_\[A-Za-z0-9\]+\$" },*  
*"city": { "type": "string" },*  
*"device": {*  
*"type": "object",*  
*"properties": {*  
*"ua_hash": { "type": "string" },*  
*"os": { "type": "string" },*  
*"app_ver": { "type": "string" }*  
*},*  
*"additionalProperties": false*  
*},*  
*"context": {*  
*"type": "object",*  
*"required": \["role", "env"\],*  
*"properties": {*  
*"role": { "type": "string", "enum": \["buyer","seller","studio_owner","admin","guest"\] },*  
*"env": { "type": "string", "enum": \["dev","stage","prod"\] }*  
*},*  
*"additionalProperties": true*  
*},*  
*"ids": {*  
*"type": "object",*  
*"properties": {*  
*"lbg_id": { "type": "string", "pattern": "^lbg\_" },*  
*"leg_id": { "type": "string", "pattern": "^leg\_" },*  
*"doc_id": { "type": "string", "pattern": "^doc\_" },*  
*"impression_id": { "type": "string", "pattern": "^imp\_" },*  
*"campaign_id": { "type": "string", "pattern": "^pcmp\_" }*  
*},*  
*"additionalProperties": true*  
*},*  
*"money": {*  
*"type": "object",*  
*"properties": {*  
*"amount_cents": { "type": "integer", "minimum": 0 },*  
*"currency": { "type": "string", "minLength": 3, "maxLength": 3 }*  
*},*  
*"additionalProperties": false*  
*},*  
*"payload": { "type": "object" }*  
*},*  
*"additionalProperties": false*  
*}*  

**PIIâ€‘free rule:** No names, emails, phones, exact addresses, or images in events. Join to PII only inside **Silver private** models when absolutely necessary.
