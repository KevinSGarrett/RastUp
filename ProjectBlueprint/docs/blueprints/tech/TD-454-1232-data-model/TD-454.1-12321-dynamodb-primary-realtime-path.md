---
id: TD-454.1
title: "**1.23.2.1 DynamoDB (primary, realtime path)**"
source_doc: "TechDevBlueprint.docx"
source_path: "docs\blueprints\tech\TD-454-1232-data-model\TD-454.1-12321-dynamodb-primary-realtime-path.md"
parent_id: TD-454
anchor: "TD-454.1"
checksum: "sha256:3dfd605aae1ab07ee5cca8de329257839d159ef09ac0f2c66cdb8c92274a55b3"
last_modified: "2025-11-06T20:40:46Z"
doc_kind: "TD"
h_level: 3
---
<a id="TD-454.1"></a>
### **1.23.2.1 DynamoDB (primary, realtime path)**

**Table:** ***msg_threads*** **(PK =** ***threadId*****, SK = constant)**  
Attributes:

- *threadId* (string, *th\_…*) **PK**
- *type* (enum: *INQUIRY\|INVITE\|BOOKING\|DISPUTE\|SYSTEM*) — non‑tech “Type” list.

NonTechBlueprint

- *roleContext* (string enum: *Model\|Photographer\|Videographer\|Creator* etc.) — as per service profile role.

NonTechBlueprint

- *participants* (\[userId\])
- *bookingId* (nullable)
- *status* (enum: *OPEN\|AWAITING_REPLY\|PENDING_DECISION\|CONFIRMED\|COMPLETED\|DISPUTED\|ARCHIVED*) — mirrors non‑tech.

NonTechBlueprint

- *lastMessageAt* (epoch ms), *unreadCountByUser* (map), *lastSenderId*
- *requestState* (enum: *REQUESTS\|ACCEPTED\|DECLINED*)
- *safetyFlags* ({blockedUserIds:\[\], mutedUserIds:\[\], tnsFlags:\[\]})
- *projectSnapshot* (summary subset for right‑pane Project Panel—see below)

**Table:** ***msg_messages*** **(PK =** ***threadId*****, SK =** ***ts#\<epoch\>#\<rand\>*** **for ordering)**  
Attributes:

- *threadId* (string) **PK**, *msgKey* (string) **SK**
- *messageId* (*m\_…*), *senderId*, *ts* (epoch ms)
- *kind* (enum: *TEXT\|ATTACHMENT\|ACTION\|SYSTEM\|STATE*)
- *content* (JSON; text markdown subset for *TEXT*)
- *attachments* (\[{*key*,*mime*,*bytes*,*hash*,*thumbKey*}\]) — presigned S3 keys
- *action* (nullable Action Card payload; see §1.23.6)
- *stateChange* ({*type*: *READ\|DELIVERED\|TYPING_ON\|TYPING_OFF*, *targets*:\[userId\]})
- *safeModeBand* (int *0\|1\|2* for preview gating)
- *spamScore* (float), *policyTags* (\[*HARASSMENT\|DOXXING\|NSFW*…\]) — for triage routing.

NonTechBlueprint_Part3

- GSIs:

  - *gsiUserThreads* (PK=*userId*, SK=*lastMessageAt* desc) for inbox list
  - *gsiSearch* (PK=*threadId*, SK=*textIndex*) optional if we keep Typesense as the search frontend
