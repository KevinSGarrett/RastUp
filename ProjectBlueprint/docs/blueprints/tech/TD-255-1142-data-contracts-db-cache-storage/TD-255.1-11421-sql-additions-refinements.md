---
id: TD-255.1
title: "**1.14.2.1 SQL (additions & refinements)**"
source_doc: "TechDevBlueprint.docx"
source_path: "docs\blueprints\tech\TD-255-1142-data-contracts-db-cache-storage\TD-255.1-11421-sql-additions-refinements.md"
parent_id: TD-255
anchor: "TD-255.1"
checksum: "sha256:59e40423a03e887016fd1f8c64a537a1ef1fd267dfe387afed4187004cf8e65f"
last_modified: "2025-11-06T20:40:46Z"
doc_kind: "TD"
h_level: 3
---
<a id="TD-255.1"></a>
### **1.14.2.1 SQL (additions & refinements)**

*-- Creator storefront settings & policy*  
*alter table fansub_creator*  
*add column preview_policy jsonb not null default jsonb_build_object(*  
*'image_max_px', 1600, 'video_preview_sec', 15, 'watermark', true, 'nsfw_on_public', false*  
*),*  
*add column payout_schedule text not null default 'standard', -- 'standard' \| 'weekly' (Stripe Connect)*  
*add column tos_accepted_at timestamptz,*  
*add column dmca_contact_email text;*  
  
*-- Subscription invoice snapshots (for statements & taxes)*  
*create table fansub_subscription_invoice (*  
*inv_id text primary key, -- fsi\_...*  
*sub_id text not null references fansub_subscription(sub_id),*  
*provider_invoice text not null, -- Stripe invoice id*  
*period_start timestamptz not null,*  
*period_end timestamptz not null,*  
*amount_cents int not null, -- subtotal (creator portion)*  
*tax_cents int not null,*  
*fee_cents int not null, -- platform fee taken (if any)*  
*fee_tax_cents int not null,*  
*currency text not null default 'USD',*  
*status text not null check (status in ('paid','void','uncollectible')),*  
*created_at timestamptz not null default now()*  
*);*  
  
*-- Creator payout ledger (join to Stripe balance txns)*  
*create table fansub_payout (*  
*payout_id text primary key, -- fpo\_...*  
*creator_id text not null,*  
*provider_transfer text not null, -- Stripe transfer/payout id*  
*amount_cents int not null,*  
*status text not null check (status in ('queued','paid','failed')),*  
*scheduled_for timestamptz,*  
*created_at timestamptz not null default now()*  
*);*
